<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Yalin Zhu, My life" />





  <link rel="alternate" href="/atom.xml" title="Yalin Zhu's Homepage" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="ProblemSolution
    Tests of goodness-of-fit (expected frequency)
        Chi-square test
        Exact binomial test
    Tests of independence (comparing groups)
        Chi-square test
        Fishe">
<meta property="og:type" content="article">
<meta property="og:title" content="Frequency tests">
<meta property="og:url" content="http://yoursite.com/2016/04/07/Frequency-test/index.html">
<meta property="og:site_name" content="Yalin Zhu's Homepage">
<meta property="og:description" content="ProblemSolution
    Tests of goodness-of-fit (expected frequency)
        Chi-square test
        Exact binomial test
    Tests of independence (comparing groups)
        Chi-square test
        Fishe">
<meta property="og:updated_time" content="2016-04-07T22:29:46.181Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Frequency tests">
<meta name="twitter:description" content="ProblemSolution
    Tests of goodness-of-fit (expected frequency)
        Chi-square test
        Exact binomial test
    Tests of independence (comparing groups)
        Chi-square test
        Fishe">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title> Frequency tests | Yalin Zhu's Homepage </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', '75778678', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Yalin Zhu's Homepage</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">In God we trust, all others bring data.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Frequency tests
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-04-07T18:10:28-04:00" content="2016-04-07">
              2016-04-07
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/07/Frequency-test/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/07/Frequency-test/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><pre><code>Solution
    Tests of goodness-of-fit (expected frequency)
        Chi-square test
        Exact binomial test
    Tests of independence (comparing groups)
        Chi-square test
        Fisher�s exact test
        Cochran-Mantel-Haenszel test
    McNemar�s test
</code></pre><h1 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem"></a>Problem</h1><hr>
<p>You have categorical data and want test whether the frequency distribution of values differs from an expected frequency, or if the distribution differs between groups.</p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><hr>
<p>There are two general questions that frequency tests address:</p>
<ol>
<li><p>Does the frequency distribution differ from an expected, or theoretical, distribution (e.g., expect 50% yes, 50% no)? (Goodness-of-fit test)</p>
</li>
<li><p>Does the frequency distribution differ between two or more groups? (Independence test)</p>
</li>
</ol>
<hr>
<p>Of the statistical tests commonly used to address these questions, there are exact tests and approximate tests.<br>      Expected distribution     Comparing groups<br>Exact     Exact binomial     Fisher�s exact<br>Approximate     Chi-square goodness of fit     Chi-square test of independence</p>
<p>Note: The exact binomial test can only be used on one variable that has two levels. Fisher�s exact test can only be used with two-dimensional contingency tables (for example, it can be used when there is one independent variable and one dependent variable, but not when there are 2 IVs and 1 DV).</p>
<p>To test for paired or within-subjects effects, McNemar�s test can be used. To use it, there must be one IV with two levels, and one DV with two levels.</p>
<p>To test for the independence of two variables with repeated measurements, the Cochran-Mantel-Haenszel test can be used.</p>
<p>Suppose this is your data, where each row represents one case:</p>
<p>data &lt;- read.table(header=TRUE, text=’<br> condition result<br>   control      0<br>   control      0<br>   control      0<br>   control      0<br> treatment      1<br>   control      0<br>   control      0<br> treatment      0<br> treatment      1<br>   control      1<br> treatment      1<br> treatment      1<br> treatment      1<br> treatment      1<br> treatment      0<br>   control      0<br>   control      1<br>   control      0<br>   control      1<br> treatment      0<br> treatment      1<br> treatment      0<br> treatment      0<br>   control      0<br> treatment      1<br>   control      0<br>   control      0<br> treatment      1<br> treatment      0<br> treatment      1<br>‘)</p>
<p>Instead of a data frame of cases, your data might be stored as a data frame of counts, or as a contingency table. For the analyses here, your data must be in a contingency table. See this page for more information.<br>Tests of goodness-of-fit (expected frequency)<br>Chi-square test</p>
<p>To test the hypothesis that the two values in the result column (ignoring condition) are equally likely (50%-50%) in the population:</p>
<h1 id="Create-contingency-table-for-result-which-contains-values-0-and-1"><a href="#Create-contingency-table-for-result-which-contains-values-0-and-1" class="headerlink" title="Create contingency table for result, which contains values 0 and 1"></a>Create contingency table for result, which contains values 0 and 1</h1><h1 id="The-column-names-are-“0”-and-“1”-they’re-not-actually-values-in-the-table"><a href="#The-column-names-are-“0”-and-“1”-they’re-not-actually-values-in-the-table" class="headerlink" title="The column names are “0” and “1” (they’re not actually values in the table)"></a>The column names are “0” and “1” (they’re not actually values in the table)</h1><p>ct &lt;- table(data$result)<br>ct</p>
<p>#&gt; </p>
<p>#&gt;  0  1 </p>
<p>#&gt; 17 13</p>
<h1 id="An-alternative-is-to-manually-create-the-table"><a href="#An-alternative-is-to-manually-create-the-table" class="headerlink" title="An alternative is to manually create the table"></a>An alternative is to manually create the table</h1><p>#ct &lt;- matrix(c(17,13), ncol=2)</p>
<p>#colnames(ct1) &lt;- c(“0”, “1”)</p>
<h1 id="Perform-Chi-square-test"><a href="#Perform-Chi-square-test" class="headerlink" title="Perform Chi-square test"></a>Perform Chi-square test</h1><p>chisq.test(ct)</p>
<p>#&gt; </p>
<p>#&gt;     Chi-squared test for given probabilities</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; X-squared = 0.5333, df = 1, p-value = 0.4652</p>
<p>To test the sample with different expected frequencies (in this case 0.75 and 0.25):</p>
<h1 id="Probability-table-must-sum-to-1"><a href="#Probability-table-must-sum-to-1" class="headerlink" title="Probability table - must sum to 1"></a>Probability table - must sum to 1</h1><p>pt &lt;- c(.75, .25)<br>chisq.test(ct, p=pt)</p>
<p>#&gt; </p>
<p>#&gt;     Chi-squared test for given probabilities</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; X-squared = 5.3778, df = 1, p-value = 0.02039</p>
<p>If you want to extract information out of the test result, you can save the result into a variable, examine the variable with str(), and pull out the parts you want. For example:</p>
<p>chi_res &lt;- chisq.test(ct, p=pt)</p>
<h1 id="View-all-the-parts-that-can-be-extracted"><a href="#View-all-the-parts-that-can-be-extracted" class="headerlink" title="View all the parts that can be extracted"></a>View all the parts that can be extracted</h1><p>str(chi_res)</p>
<p>#&gt; List of 9</p>
<p>#&gt;  $ statistic: Named num 5.38</p>
<p>#&gt;   ..- attr(*, “names”)= chr “X-squared”</p>
<p>#&gt;  $ parameter: Named num 1</p>
<p>#&gt;   ..- attr(*, “names”)= chr “df”</p>
<p>#&gt;  $ p.value  : num 0.0204</p>
<p>#&gt;  $ method   : chr “Chi-squared test for given probabilities”</p>
<p>#&gt;  $ data.name: chr “ct”</p>
<p>#&gt;  $ observed : ‘table’ int [1:2(1d)] 17 13</p>
<p>#&gt;   ..- attr(*, “dimnames”)=List of 1</p>
<p>#&gt;   .. ..$ : chr [1:2] “0” “1”</p>
<p>#&gt;  $ expected : Named num [1:2] 22.5 7.5</p>
<p>#&gt;   ..- attr(*, “names”)= chr [1:2] “0” “1”</p>
<p>#&gt;  $ residuals: table [1:2(1d)] -1.16 2.01</p>
<p>#&gt;   ..- attr(*, “dimnames”)=List of 1</p>
<p>#&gt;   .. ..$ : chr [1:2] “0” “1”</p>
<p>#&gt;  $ stdres   : table [1:2(1d)] -2.32 2.32</p>
<p>#&gt;   ..- attr(*, “dimnames”)=List of 1</p>
<p>#&gt;   .. ..$ : chr [1:2] “0” “1”</p>
<p>#&gt;  - attr(*, “class”)= chr “htest”</p>
<h1 id="Get-the-Chi-squared-value"><a href="#Get-the-Chi-squared-value" class="headerlink" title="Get the Chi-squared value"></a>Get the Chi-squared value</h1><p>chi_res$statistic</p>
<p>#&gt; X-squared </p>
<p>#&gt;  5.377778</p>
<h1 id="Get-the-p-value"><a href="#Get-the-p-value" class="headerlink" title="Get the p-value"></a>Get the p-value</h1><p>chi_res$p.value</p>
<p>#&gt; [1] 0.02039484</p>
<p>Exact binomial test</p>
<p>The exact binomial test is used only with data where there is one variable with two possible values.</p>
<p>ct &lt;- table(data$result)<br>ct</p>
<p>#&gt; </p>
<p>#&gt;  0  1 </p>
<p>#&gt; 17 13</p>
<p>binom.test(ct, p=0.5)</p>
<p>#&gt; </p>
<p>#&gt;     Exact binomial test</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; number of successes = 17, number of trials = 30, p-value = 0.5847</p>
<p>#&gt; alternative hypothesis: true probability of success is not equal to 0.5</p>
<p>#&gt; 95 percent confidence interval:</p>
<p>#&gt;  0.3742735 0.7453925</p>
<p>#&gt; sample estimates:</p>
<p>#&gt; probability of success </p>
<p>#&gt;              0.5666667</p>
<h1 id="Using-expected-probability-of-75-–-notice-that-1-is-in-the-second-column-of"><a href="#Using-expected-probability-of-75-–-notice-that-1-is-in-the-second-column-of" class="headerlink" title="Using expected probability of 75% – notice that 1 is in the second column of"></a>Using expected probability of 75% – notice that 1 is in the second column of</h1><h1 id="the-table-so-need-to-use-p-25"><a href="#the-table-so-need-to-use-p-25" class="headerlink" title="the table so need to use p=.25"></a>the table so need to use p=.25</h1><p>binom.test(ct, p=0.25)</p>
<p>#&gt; </p>
<p>#&gt;     Exact binomial test</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; number of successes = 17, number of trials = 30, p-value = 0.0002157</p>
<p>#&gt; alternative hypothesis: true probability of success is not equal to 0.25</p>
<p>#&gt; 95 percent confidence interval:</p>
<p>#&gt;  0.3742735 0.7453925</p>
<p>#&gt; sample estimates:</p>
<p>#&gt; probability of success </p>
<p>#&gt;              0.5666667</p>
<p>If you want to extract information out of the test result, you can save the result into a variable, examine the variable with str(), and pull out the parts you want. For example:</p>
<p>bin_res &lt;- binom.test(ct, p=0.25)</p>
<h1 id="View-all-the-parts-that-can-be-extracted-1"><a href="#View-all-the-parts-that-can-be-extracted-1" class="headerlink" title="View all the parts that can be extracted"></a>View all the parts that can be extracted</h1><p>str(bin_res)</p>
<p>#&gt; List of 9</p>
<p>#&gt;  $ statistic  : Named num 17</p>
<p>#&gt;   ..- attr(*, “names”)= chr “number of successes”</p>
<p>#&gt;  $ parameter  : Named num 30</p>
<p>#&gt;   ..- attr(*, “names”)= chr “number of trials”</p>
<p>#&gt;  $ p.value    : Named num 0.000216</p>
<p>#&gt;   ..- attr(*, “names”)= chr “0”</p>
<p>#&gt;  $ conf.int   : atomic [1:2] 0.374 0.745</p>
<p>#&gt;   ..- attr(*, “conf.level”)= num 0.95</p>
<p>#&gt;  $ estimate   : Named num 0.567</p>
<p>#&gt;   ..- attr(*, “names”)= chr “probability of success”</p>
<p>#&gt;  $ null.value : Named num 0.25</p>
<p>#&gt;   ..- attr(*, “names”)= chr “probability of success”</p>
<p>#&gt;  $ alternative: chr “two.sided”</p>
<p>#&gt;  $ method     : chr “Exact binomial test”</p>
<p>#&gt;  $ data.name  : chr “ct”</p>
<p>#&gt;  - attr(*, “class”)= chr “htest”</p>
<h1 id="Get-the-p-value-1"><a href="#Get-the-p-value-1" class="headerlink" title="Get the p-value"></a>Get the p-value</h1><p>bin_res$p.value</p>
<p>#&gt;            0 </p>
<p>#&gt; 0.0002156938</p>
<h1 id="Get-the-95-confidence-interval"><a href="#Get-the-95-confidence-interval" class="headerlink" title="Get the 95% confidence interval"></a>Get the 95% confidence interval</h1><p>bin_res$conf.int</p>
<p>#&gt; [1] 0.3742735 0.7453925</p>
<p>#&gt; attr(,”conf.level”)</p>
<p>#&gt; [1] 0.95</p>
<p>Tests of independence (comparing groups)<br>Chi-square test</p>
<p>To test whether the control and treatment conditions result in different frequencies, use a 2D contingency table.</p>
<p>ct &lt;- table(data$condition, data$result)<br>ct</p>
<p>#&gt;            </p>
<p>#&gt;              0  1</p>
<p>#&gt;   control   11  3</p>
<p>#&gt;   treatment  6 10</p>
<p>chisq.test(ct)</p>
<p>#&gt; </p>
<p>#&gt;     Pearson’s Chi-squared test with Yates’ continuity correction</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; X-squared = 3.593, df = 1, p-value = 0.05802</p>
<p>chisq.test(ct, correct=FALSE)</p>
<p>#&gt; </p>
<p>#&gt;     Pearson’s Chi-squared test</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; X-squared = 5.1293, df = 1, p-value = 0.02353</p>
<p>For 2x2 tables, it uses Yates�s continuity correction by default. This test is more conservative for small sample sizes.<br>The flag correct=FALSE, tells it to use Pearson�s chi-square test without the correction.<br>Fisher�s exact test</p>
<p>For small sample sizes, Fisher�s exact test may be more appropriate. It is typically used for 2x2 tables with relatively small sample sizes because it is computationally intensive for more complicated (e.g., 2x3) tables, and those with larger sample sizes. However, the implementation in R seems to handle larger cases without trouble.</p>
<p>ct &lt;- table(data$condition, data$result)<br>ct</p>
<p>#&gt;            </p>
<p>#&gt;              0  1</p>
<p>#&gt;   control   11  3</p>
<p>#&gt;   treatment  6 10</p>
<p>fisher.test(ct)</p>
<p>#&gt; </p>
<p>#&gt;     Fisher’s Exact Test for Count Data</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; p-value = 0.03293</p>
<p>#&gt; alternative hypothesis: true odds ratio is not equal to 1</p>
<p>#&gt; 95 percent confidence interval:</p>
<p>#&gt;   0.966861 45.555016</p>
<p>#&gt; sample estimates:</p>
<p>#&gt; odds ratio </p>
<p>#&gt;   5.714369</p>
<p>Cochran-Mantel-Haenszel test</p>
<p>The Cochran-Mantel-Haenszel test (or Mantel-Haenszel test) is used for testing the independence of two dichotomous variables with repeated measurements. It is most commonly used with 2x2xK tables, where K is the number of measurement conditions. For example, you may want to know whether a treatment (C vs. D) affects the likelihood of recovery (yes or no). Suppose, though, that the treatments were administered at three different times of day, morning, afternoon, and night � and that you want your test to control for this. The CMH test would then operate on a 2x2x3 contingency table, where the third variable is the one you wish to control for.</p>
<p>The implementation of the CMH test in R can handle dimensions greater than 2x2xK. For example, you could use it for a 3x3xK contingency table.</p>
<p>In the following example (borrowed from McDonald�s Handbook of Biological Statistics), there are three variables: Location, Allele, and Habitat. The question is whether Allele (94 or non-94) and Habitat (marine or estuarine) are independent, when location is controlled for.</p>
<p>fish &lt;- read.table(header=TRUE, text=’<br>  Location Allele   Habitat Count<br> tillamook     94    marine    56<br> tillamook     94 estuarine    69<br> tillamook non-94    marine    40<br> tillamook non-94 estuarine    77<br>   yaquina     94    marine    61<br>   yaquina     94 estuarine   257<br>   yaquina non-94    marine    57<br>   yaquina non-94 estuarine   301<br>     alsea     94    marine    73<br>     alsea     94 estuarine    65<br>     alsea non-94    marine    71<br>     alsea non-94 estuarine    79<br>    umpqua     94    marine    71<br>    umpqua     94 estuarine    48<br>    umpqua non-94    marine    55<br>    umpqua non-94 estuarine    48<br>‘)</p>
<p>Note that the data above is entered as a data frame of counts, instead of a data frame of cases as in previous examples. Instead of using table() to convert it to a contingency table, use xtabs() instead. For more information, see this page.</p>
<h1 id="Make-a-3D-contingency-table-where-the-last-variable-Location-is-the-one-to"><a href="#Make-a-3D-contingency-table-where-the-last-variable-Location-is-the-one-to" class="headerlink" title="Make a 3D contingency table, where the last variable, Location, is the one to"></a>Make a 3D contingency table, where the last variable, Location, is the one to</h1><h1 id="control-for-If-you-use-table-for-case-data-the-last-variable-is-also-the"><a href="#control-for-If-you-use-table-for-case-data-the-last-variable-is-also-the" class="headerlink" title="control for. If you use table() for case data, the last variable is also the"></a>control for. If you use table() for case data, the last variable is also the</h1><h1 id="one-to-control-for"><a href="#one-to-control-for" class="headerlink" title="one to control for."></a>one to control for.</h1><p>ct &lt;- xtabs(Count ~ Allele + Habitat + Location, data=fish)<br>ct</p>
<p>#&gt; , , Location = alsea</p>
<p>#&gt; </p>
<p>#&gt;         Habitat</p>
<p>#&gt; Allele   estuarine marine</p>
<p>#&gt;   94            65     73</p>
<p>#&gt;   non-94        79     71</p>
<p>#&gt; </p>
<p>#&gt; , , Location = tillamook</p>
<p>#&gt; </p>
<p>#&gt;         Habitat</p>
<p>#&gt; Allele   estuarine marine</p>
<p>#&gt;   94            69     56</p>
<p>#&gt;   non-94        77     40</p>
<p>#&gt; </p>
<p>#&gt; , , Location = umpqua</p>
<p>#&gt; </p>
<p>#&gt;         Habitat</p>
<p>#&gt; Allele   estuarine marine</p>
<p>#&gt;   94            48     71</p>
<p>#&gt;   non-94        48     55</p>
<p>#&gt; </p>
<p>#&gt; , , Location = yaquina</p>
<p>#&gt; </p>
<p>#&gt;         Habitat</p>
<p>#&gt; Allele   estuarine marine</p>
<p>#&gt;   94           257     61</p>
<p>#&gt;   non-94       301     57</p>
<h1 id="This-prints-ct-in-a-“flat”-format"><a href="#This-prints-ct-in-a-“flat”-format" class="headerlink" title="This prints ct in a “flat” format"></a>This prints ct in a “flat” format</h1><p>ftable(ct)</p>
<p>#&gt;                  Location alsea tillamook umpqua yaquina</p>
<p>#&gt; Allele Habitat                                          </p>
<p>#&gt; 94     estuarine             65        69     48     257</p>
<p>#&gt;        marine                73        56     71      61</p>
<p>#&gt; non-94 estuarine             79        77     48     301</p>
<p>#&gt;        marine                71        40     55      57</p>
<h1 id="Print-with-different-arrangement-of-variables"><a href="#Print-with-different-arrangement-of-variables" class="headerlink" title="Print with different arrangement of variables"></a>Print with different arrangement of variables</h1><p>ftable(ct, row.vars=c(“Location”,”Allele”), col.vars=”Habitat”)</p>
<p>#&gt;                  Habitat estuarine marine</p>
<p>#&gt; Location  Allele                         </p>
<p>#&gt; alsea     94                    65     73</p>
<p>#&gt;           non-94                79     71</p>
<p>#&gt; tillamook 94                    69     56</p>
<p>#&gt;           non-94                77     40</p>
<p>#&gt; umpqua    94                    48     71</p>
<p>#&gt;           non-94                48     55</p>
<p>#&gt; yaquina   94                   257     61</p>
<p>#&gt;           non-94               301     57</p>
<p>mantelhaen.test(ct)</p>
<p>#&gt; </p>
<p>#&gt;     Mantel-Haenszel chi-squared test with continuity correction</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463</p>
<p>#&gt; alternative hypothesis: true common odds ratio is not equal to 1</p>
<p>#&gt; 95 percent confidence interval:</p>
<p>#&gt;  0.6005522 0.9593077</p>
<p>#&gt; sample estimates:</p>
<p>#&gt; common odds ratio </p>
<p>#&gt;          0.759022</p>
<p>According to this test, there is a relationship between Allele and Habitat, controlling for Location, p=.025.</p>
<p>Note that the first two dimensions of the contingency table are treated the same (so their order can be swapped without affecting the test result), the highest-order dimension in the contingency table is different. This is illustrated below.</p>
<h1 id="The-following-two-create-different-contingency-tables-but-have-the-same-result"><a href="#The-following-two-create-different-contingency-tables-but-have-the-same-result" class="headerlink" title="The following two create different contingency tables, but have the same result"></a>The following two create different contingency tables, but have the same result</h1><h1 id="with-the-CMH-test"><a href="#with-the-CMH-test" class="headerlink" title="with the CMH test"></a>with the CMH test</h1><p>ct.1 &lt;- xtabs(Count ~ Habitat + Allele + Location, data=fish)<br>ct.2 &lt;- xtabs(Count ~ Allele + Habitat + Location, data=fish)<br>mantelhaen.test(ct.1)</p>
<p>#&gt; </p>
<p>#&gt;     Mantel-Haenszel chi-squared test with continuity correction</p>
<p>#&gt; </p>
<p>#&gt; data:  ct.1</p>
<p>#&gt; Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463</p>
<p>#&gt; alternative hypothesis: true common odds ratio is not equal to 1</p>
<p>#&gt; 95 percent confidence interval:</p>
<p>#&gt;  0.6005522 0.9593077</p>
<p>#&gt; sample estimates:</p>
<p>#&gt; common odds ratio </p>
<p>#&gt;          0.759022<br>mantelhaen.test(ct.2)</p>
<p>#&gt; </p>
<p>#&gt;     Mantel-Haenszel chi-squared test with continuity correction</p>
<p>#&gt; </p>
<p>#&gt; data:  ct.2</p>
<p>#&gt; Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463</p>
<p>#&gt; alternative hypothesis: true common odds ratio is not equal to 1</p>
<p>#&gt; 95 percent confidence interval:</p>
<p>#&gt;  0.6005522 0.9593077</p>
<p>#&gt; sample estimates:</p>
<p>#&gt; common odds ratio </p>
<p>#&gt;          0.759022</p>
<h1 id="With-Allele-last-we-get-a-different-result"><a href="#With-Allele-last-we-get-a-different-result" class="headerlink" title="With Allele last, we get a different result"></a>With Allele last, we get a different result</h1><p>ct.3 &lt;- xtabs(Count ~ Location + Habitat + Allele, data=fish)<br>ct.4 &lt;- xtabs(Count ~ Habitat + Location + Allele, data=fish)<br>mantelhaen.test(ct.3)</p>
<p>#&gt; </p>
<p>#&gt;     Cochran-Mantel-Haenszel test</p>
<p>#&gt; </p>
<p>#&gt; data:  ct.3</p>
<p>#&gt; Cochran-Mantel-Haenszel M^2 = 168.4684, df = 3, p-value &lt; 2.2e-16<br>mantelhaen.test(ct.4)</p>
<p>#&gt; </p>
<p>#&gt;     Cochran-Mantel-Haenszel test</p>
<p>#&gt; </p>
<p>#&gt; data:  ct.4</p>
<p>#&gt; Cochran-Mantel-Haenszel M^2 = 168.4684, df = 3, p-value &lt; 2.2e-16</p>
<h1 id="With-Habitat-last-we-get-a-different-result"><a href="#With-Habitat-last-we-get-a-different-result" class="headerlink" title="With Habitat last, we get a different result"></a>With Habitat last, we get a different result</h1><p>ct.5 &lt;- xtabs(Count ~ Allele + Location + Habitat, data=fish)<br>ct.6 &lt;- xtabs(Count ~ Location + Allele + Habitat, data=fish)<br>mantelhaen.test(ct.5)</p>
<p>#&gt; </p>
<p>#&gt;     Cochran-Mantel-Haenszel test</p>
<p>#&gt; </p>
<p>#&gt; data:  ct.5</p>
<p>#&gt; Cochran-Mantel-Haenszel M^2 = 2.0168, df = 3, p-value = 0.5689<br>mantelhaen.test(ct.6)</p>
<p>#&gt; </p>
<p>#&gt;     Cochran-Mantel-Haenszel test</p>
<p>#&gt; </p>
<p>#&gt; data:  ct.6</p>
<p>#&gt; Cochran-Mantel-Haenszel M^2 = 2.0168, df = 3, p-value = 0.5689</p>
<p>McNemar�s test</p>
<p>McNemar�s test is conceptually like a within-subjects test for frequency data. For example, suppose you want to test whether a treatment increases the probability that a person will respond �yes� to a question, and that you get just one pre-treatment and one post-treatment response per person. A standard chi-square test would be inappropriate, because it assumes that the groups are independent. Instead, McNemar�s test can be used. This test can only be used when there are two measurements of a dichotomous variable. The 2x2 contingency table used for McNemar�s test bears a superficial resemblance to those used for �normal� chi-square tests, but it is different in structure.</p>
<p>Suppose this is your data. Each subject has a pre-treatment and post-treatment response.</p>
<p>data &lt;- read.table(header=TRUE, text=’<br> subject time result<br>       1  pre      0<br>       1 post      1<br>       2  pre      1<br>       2 post      1<br>       3  pre      0<br>       3 post      1<br>       4  pre      1<br>       4 post      0<br>       5  pre      1<br>       5 post      1<br>       6  pre      0<br>       6 post      1<br>       7  pre      0<br>       7 post      1<br>       8  pre      0<br>       8 post      1<br>       9  pre      0<br>       9 post      1<br>      10  pre      1<br>      10 post      1<br>      11  pre      0<br>      11 post      0<br>      12  pre      1<br>      12 post      1<br>      13  pre      0<br>      13 post      1<br>      14  pre      0<br>      14 post      0<br>      15  pre      0<br>      15 post      1<br>‘)</p>
<p>If your data is not already in wide format, it must be converted (see this page for more information):</p>
<p>library(tidyr)</p>
<p>data_wide &lt;- spread(data, time, result)<br>data_wide</p>
<p>#&gt;    subject post pre</p>
<p>#&gt; 1        1    1   0</p>
<p>#&gt; 2        2    1   1</p>
<p>#&gt; 3        3    1   0</p>
<p>#&gt; 4        4    0   1</p>
<p>#&gt; 5        5    1   1</p>
<p>#&gt; 6        6    1   0</p>
<p>#&gt; 7        7    1   0</p>
<p>#&gt; 8        8    1   0</p>
<p>#&gt; 9        9    1   0</p>
<p>#&gt; 10      10    1   1</p>
<p>#&gt; 11      11    0   0</p>
<p>#&gt; 12      12    1   1</p>
<p>#&gt; 13      13    1   0</p>
<p>#&gt; 14      14    0   0</p>
<p>#&gt; 15      15    1   0</p>
<p>Next, generate the contingency table from just the pre and post columns from the data frame:</p>
<p>ct &lt;- table( data_wide[,c(“pre”,”post”)] )<br>ct</p>
<p>#&gt;    post</p>
<p>#&gt; pre 0 1</p>
<p>#&gt;   0 2 8</p>
<p>#&gt;   1 1 4</p>
<h1 id="The-contingency-table-above-puts-each-subject-into-one-of-four-cells-depending"><a href="#The-contingency-table-above-puts-each-subject-into-one-of-four-cells-depending" class="headerlink" title="The contingency table above puts each subject into one of four cells, depending"></a>The contingency table above puts each subject into one of four cells, depending</h1><h1 id="on-their-pre-and-post-treatment-response-Note-that-it-it-is-different-from"><a href="#on-their-pre-and-post-treatment-response-Note-that-it-it-is-different-from" class="headerlink" title="on their pre- and post-treatment response. Note that it it is different from"></a>on their pre- and post-treatment response. Note that it it is different from</h1><h1 id="the-contingency-table-used-for-a-“normal”-chi-square-test-shown-below-The-table"><a href="#the-contingency-table-used-for-a-“normal”-chi-square-test-shown-below-The-table" class="headerlink" title="the contingency table used for a “normal” chi-square test, shown below. The table"></a>the contingency table used for a “normal” chi-square test, shown below. The table</h1><h1 id="below-does-not-account-for-repeated-measurements-and-so-it-is-not-useful-for"><a href="#below-does-not-account-for-repeated-measurements-and-so-it-is-not-useful-for" class="headerlink" title="below does not account for repeated measurements, and so it is not useful for"></a>below does not account for repeated measurements, and so it is not useful for</h1><h1 id="the-purposes-here"><a href="#the-purposes-here" class="headerlink" title="the purposes here."></a>the purposes here.</h1><h1 id="table-data-c-“time”-”result”"><a href="#table-data-c-“time”-”result”" class="headerlink" title="table(data[,c(“time”,”result”)])"></a>table(data[,c(“time”,”result”)])</h1><h1 id="result"><a href="#result" class="headerlink" title="result"></a>result</h1><h1 id="time-0-1"><a href="#time-0-1" class="headerlink" title="time    0  1"></a>time    0  1</h1><h1 id="post-3-12"><a href="#post-3-12" class="headerlink" title="post  3 12"></a>post  3 12</h1><h1 id="pre-10-5"><a href="#pre-10-5" class="headerlink" title="pre  10  5"></a>pre  10  5</h1><p>After creating the appropriate contingency table, run the test:</p>
<p>mcnemar.test(ct)</p>
<p>#&gt; </p>
<p>#&gt;     McNemar’s Chi-squared test with continuity correction</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; McNemar’s chi-squared = 4, df = 1, p-value = 0.0455</p>
<p>For small sample sizes, it uses a continuity correction. Instead of using this correction, you can use an exact version of McNemar�s test, which is more accurate. It is available in the package exact2x2.</p>
<p>library(exact2x2)</p>
<p>#&gt; Loading required package: exactci</p>
<p>#&gt; Loading required package: ssanv<br>mcnemar.exact(ct)</p>
<p>#&gt; </p>
<p>#&gt;     Exact McNemar test (with central confidence intervals)</p>
<p>#&gt; </p>
<p>#&gt; data:  ct</p>
<p>#&gt; b = 8, c = 1, p-value = 0.03906</p>
<p>#&gt; alternative hypothesis: true odds ratio is not equal to 1</p>
<p>#&gt; 95 percent confidence interval:</p>
<p>#&gt;    1.072554 354.981246</p>
<p>#&gt; sample estimates:</p>
<p>#&gt; odds ratio </p>
<p>#&gt;          8</p>

      
    </div>

    <div>
      
        
      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/04/07/Note-for-Analysis-of-Discrete-Data/" rel="next" title="Note for 'Analysis of Discrete Data' (1)">
                <i class="fa fa-chevron-left"></i> Note for 'Analysis of Discrete Data' (1)
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="Yalin Zhu" />
          <p class="site-author-name" itemprop="name">Yalin Zhu</p>
          <p class="site-description motion-element" itemprop="description">data player, violinist, life lover</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">12</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/yalinzhu" target="_blank">
                  
                    <i class="fa fa-globe"></i> Linkedin
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://web.njit.edu/~yz452/Resume.html" target="_blank">
                  
                    <i class="fa fa-globe"></i> Resume
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/allenzhuaz" target="_blank">
                  
                    <i class="fa fa-globe"></i> github
                  
                </a>
              </span>
            
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Problem"><span class="nav-number">1.</span> <span class="nav-text">Problem</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Problem-1"><span class="nav-number">2.</span> <span class="nav-text">Problem</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Solution"><span class="nav-number">3.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Create-contingency-table-for-result-which-contains-values-0-and-1"><span class="nav-number">4.</span> <span class="nav-text">Create contingency table for result, which contains values 0 and 1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-column-names-are-“0”-and-“1”-they’re-not-actually-values-in-the-table"><span class="nav-number">5.</span> <span class="nav-text">The column names are “0” and “1” (they’re not actually values in the table)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#An-alternative-is-to-manually-create-the-table"><span class="nav-number">6.</span> <span class="nav-text">An alternative is to manually create the table</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Perform-Chi-square-test"><span class="nav-number">7.</span> <span class="nav-text">Perform Chi-square test</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Probability-table-must-sum-to-1"><span class="nav-number">8.</span> <span class="nav-text">Probability table - must sum to 1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#View-all-the-parts-that-can-be-extracted"><span class="nav-number">9.</span> <span class="nav-text">View all the parts that can be extracted</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Get-the-Chi-squared-value"><span class="nav-number">10.</span> <span class="nav-text">Get the Chi-squared value</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Get-the-p-value"><span class="nav-number">11.</span> <span class="nav-text">Get the p-value</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Using-expected-probability-of-75-–-notice-that-1-is-in-the-second-column-of"><span class="nav-number">12.</span> <span class="nav-text">Using expected probability of 75% – notice that 1 is in the second column of</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#the-table-so-need-to-use-p-25"><span class="nav-number">13.</span> <span class="nav-text">the table so need to use p=.25</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#View-all-the-parts-that-can-be-extracted-1"><span class="nav-number">14.</span> <span class="nav-text">View all the parts that can be extracted</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Get-the-p-value-1"><span class="nav-number">15.</span> <span class="nav-text">Get the p-value</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Get-the-95-confidence-interval"><span class="nav-number">16.</span> <span class="nav-text">Get the 95% confidence interval</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Make-a-3D-contingency-table-where-the-last-variable-Location-is-the-one-to"><span class="nav-number">17.</span> <span class="nav-text">Make a 3D contingency table, where the last variable, Location, is the one to</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#control-for-If-you-use-table-for-case-data-the-last-variable-is-also-the"><span class="nav-number">18.</span> <span class="nav-text">control for. If you use table() for case data, the last variable is also the</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#one-to-control-for"><span class="nav-number">19.</span> <span class="nav-text">one to control for.</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#This-prints-ct-in-a-“flat”-format"><span class="nav-number">20.</span> <span class="nav-text">This prints ct in a “flat” format</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Print-with-different-arrangement-of-variables"><span class="nav-number">21.</span> <span class="nav-text">Print with different arrangement of variables</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-following-two-create-different-contingency-tables-but-have-the-same-result"><span class="nav-number">22.</span> <span class="nav-text">The following two create different contingency tables, but have the same result</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#with-the-CMH-test"><span class="nav-number">23.</span> <span class="nav-text">with the CMH test</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#With-Allele-last-we-get-a-different-result"><span class="nav-number">24.</span> <span class="nav-text">With Allele last, we get a different result</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#With-Habitat-last-we-get-a-different-result"><span class="nav-number">25.</span> <span class="nav-text">With Habitat last, we get a different result</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-contingency-table-above-puts-each-subject-into-one-of-four-cells-depending"><span class="nav-number">26.</span> <span class="nav-text">The contingency table above puts each subject into one of four cells, depending</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#on-their-pre-and-post-treatment-response-Note-that-it-it-is-different-from"><span class="nav-number">27.</span> <span class="nav-text">on their pre- and post-treatment response. Note that it it is different from</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#the-contingency-table-used-for-a-“normal”-chi-square-test-shown-below-The-table"><span class="nav-number">28.</span> <span class="nav-text">the contingency table used for a “normal” chi-square test, shown below. The table</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#below-does-not-account-for-repeated-measurements-and-so-it-is-not-useful-for"><span class="nav-number">29.</span> <span class="nav-text">below does not account for repeated measurements, and so it is not useful for</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#the-purposes-here"><span class="nav-number">30.</span> <span class="nav-text">the purposes here.</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#table-data-c-“time”-”result”"><span class="nav-number">31.</span> <span class="nav-text">table(data[,c(“time”,”result”)])</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#result"><span class="nav-number">32.</span> <span class="nav-text">result</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#time-0-1"><span class="nav-number">33.</span> <span class="nav-text">time    0  1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#post-3-12"><span class="nav-number">34.</span> <span class="nav-text">post  3 12</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pre-10-5"><span class="nav-number">35.</span> <span class="nav-text">pre  10  5</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yalin Zhu</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=0.5.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=0.5.0"></script>
<script type="text/javascript" src="/vendors/jquery-scrollintoview/jquery.scrollintoview.min.js?v=0.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=0.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'allenzhu';
      var disqus_identifier = '2016/04/07/Frequency-test/';
      var disqus_title = 'Frequency tests';
      var disqus_url = 'http://yoursite.com/2016/04/07/Frequency-test/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  



  
  
  

  

  

</body>
</html>
